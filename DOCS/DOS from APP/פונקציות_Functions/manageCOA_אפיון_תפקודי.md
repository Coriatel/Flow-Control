# אפיון תפקודי - ניהול תעודות אנליזה

**תאריך עדכון:** 10.11.2025
**גרסה:** 1.0
**נתיב:** functions/manageCOA.js

---

# אפיון תפקודי - manageCOA

## מטרה
ניהול מלא של תעודות אנליזה (COA) - העלאה, עדכון, מחיקה, והצגה.

## תיאור למשתמש
כשמקלטים משלוח חדש:
- 📤 מעלים את תעודת האנליזה (PDF)
- 🔗 הקובץ מקושר לאצווה
- ✅ סטטוס האצווה מתעדכן (COA uploaded)
- 🔍 ניתן לצפות/להוריד/לעדכן את ה-COA
- 📊 במעקב איכות - רואים מי חסר COA

## מקרי שימוש

### UC1: העלאת COA לאצווה חדשה
1. קלטת משלוח עם batch ABC123
2. לוחץ "העלה COA"
3. בוחר קובץ PDF
4. הקובץ עולה ומקושר
5. batch.coa_document_url מתעדכן
6. coa_uploaded_by + coa_upload_date נשמרים

### UC2: עדכון COA קיים
1. טעות בקובץ הקודם
2. לוחץ "עדכן COA"
3. מעלה קובץ חדש
4. הישן נשמר בהיסטוריה
5. החדש מוצג

### UC3: צפייה ב-COA
1. בדף QA - לוחץ על אייקון COA
2. הקובץ נפתח בטאב חדש
3. או - הורדה ישירה

## כללי עסקיים

1. **Required for Reagents**: רק קטגוריית reagents/cells/controls
2. **Not Required**: consumables/solutions
3. **Tracking**: מי העלה, מתי
4. **History**: שמירת COAs ישנים
5. **Validation**: רק PDF files
6. **Size Limit**: < 10MB per file