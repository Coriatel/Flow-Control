# מסמך בדיקות - ניהול תעודות אנליזה

**תאריך עדכון:** 10.11.2025
**גרסה:** 1.0
**נתיב:** functions/manageCOA.js

---

# מסמך בדיקות - manageCOA

## תרחישי בדיקה עיקריים

### T1: העלאת COA לאצווה
**Setup**: אצווה חדשה ללא COA

**צעדים**:
1. בחר אצווה
2. לחץ "העלה COA"
3. בחר PDF (2MB)
4. המתן להעלאה

**תוצאה מצופה**:
✅ קובץ עלה בהצלחה  
✅ batch.coa_document_url מעודכן  
✅ coa_uploaded_by = user.email  
✅ coa_upload_date = today  
✅ הודעת הצלחה  

---

### T2: עדכון COA קיים
**Setup**: אצווה עם COA קיים

**צעדים**:
1. לחץ "עדכן COA"
2. בחר PDF חדש
3. שמור

**תוצאה**:
✅ COA ישן מוחלף  
✅ URL חדש נשמר  
✅ תאריכים עודכנו  

---

### T3: קובץ לא תקין
**Setup**: מנסה להעלות .docx במקום PDF

**תוצאה**:
✅ שגיאה: "רק קבצי PDF"  
✅ batch לא עודכן  

---

### T4: קובץ גדול מדי
**Setup**: PDF של 15MB

**תוצאה**:
✅ שגיאה: "קובץ גדול מדי"  

---

### T5: צפייה ב-COA
**Setup**: אצווה עם COA

**צעדים**:
1. לחץ על אייקון "צפה"
2. COA נפתח בטאב חדש

**תוצאה**:
✅ PDF מוצג  
✅ URL נגיש  

---

### T6: מחיקת COA
**Setup**: אצווה עם COA

**צעדים**:
1. לחץ "מחק COA"
2. אישור

**תוצאה**:
✅ coa_document_url = null  
✅ האצווה עדיין קיימת  

---

## מקרי קצה

### E1: אין אינטרנט במהלך העלאה
**תוצאה**: ✅ שגיאה + retry option

### E2: batch נמחק במהלך העלאה
**תוצאה**: ✅ שגיאה "אצווה לא נמצאה"

### E3: העלאה מקבילית (2 משתמשים)
**תוצאה**: ✅ אחרון מנצח (last write wins)

---

## Checklist
- [ ] העלאת PDF
- [ ] עדכון batch
- [ ] tracking (who/when)
- [ ] validation (PDF, size)
- [ ] error messages
- [ ] צפייה/הורדה
- [ ] מחיקה
- [ ] responsive UI